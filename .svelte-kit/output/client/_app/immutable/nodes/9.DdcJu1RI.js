import{t as U,a as j,c as st}from"../chunks/disclose-version.N1JcEE3x.js";import{i as Fe}from"../chunks/legacy.Bq8hjaPg.js";import{t as C,g as e,c as a,m,s as r,b as l,r as t,p as We,l as Ee,e as ot,f as He,ab as Ke,i as nt,d as me,a as Qe,n as be}from"../chunks/runtime.BpsoJ9mv.js";import{a as h,e as y,s as lt,b as it}from"../chunks/store.CIqAHlUC.js";import{i as _e,o as ct,a as dt}from"../chunks/index-client.CY8cH23_.js";import{e as ge,i as xe}from"../chunks/Icon.oS-Lt7LZ.js";import{r as z,c as Oe,a as fe}from"../chunks/attributes.C59D3o5x.js";import{s as Xe}from"../chunks/class.DrSk-6wP.js";import{p as Je}from"../chunks/stores.8gzRtGeB.js";import{b as oe}from"../chunks/input.BWE0VUSD.js";import{b as pt}from"../chunks/select.DFFMRfw6.js";import{p as ut}from"../chunks/event-modifiers.CWmzcjye.js";import{S as vt,a as ze,A as mt}from"../chunks/square.ChP9UFil.js";import{P as Be}from"../chunks/play.B-PMHxGu.js";import{P as bt}from"../chunks/plus.DRRX1CZ4.js";import{A as ft}from"../chunks/activity.D1clQjx8.js";import{S as Ve}from"../chunks/server.CxxYWvAu.js";import{g as _t}from"../chunks/index.CEIXVWp1.js";var gt=U('<div class="py-1"> </div>'),xt=U('<div class="bg-neutral-900 rounded-lg p-4"><div class="h-[calc(100vh-400px)]  overflow-y-auto mb-4 font-mono"></div> <input class="w-full bg-neutral-800 text-white px-4 py-2 rounded" placeholder="Enter command..."></div>');function ht(V){let R=m([]),b=m("");var d=xt(),w=a(d);ge(w,5,()=>e(R),xe,(p,B)=>{var f=gt(),S=a(f,!0);t(f),C(()=>h(S,e(B))),j(p,f)}),t(w);var D=r(w,2);z(D),t(d),oe(D,()=>e(b),p=>l(b,p)),y("keydown",D,p=>{p.key==="Enter"&&(l(R,[...e(R),`$ ${e(b)}`]),l(b,""))}),j(V,d)}var yt=U('<tr class="border-b border-neutral-800 hover:bg-neutral-900/50"><td class="p-4"><input type="checkbox" class="rounded border-neutral-700 text-blue-500 focus:ring-blue-500"></td><td class="p-4"><span class="text-white"> </span> <div class="text-sm text-gray-400"> </div></td><td class="p-4"><div class="flex items-center space-x-2"><!> <span> </span></div></td><td class="p-4"><div class="flex items-center space-x-2"><!> <span> </span></div></td><td class="p-4"><span> </span></td><td class="p-4"><span> </span></td><td class="p-4"><span> </span></td><td class="p-4"><div class="flex justify-end space-x-2"><button class="p-2 hover:bg-neutral-800 rounded-lg transition-colors"><!></button></div></td></tr>'),wt=U("<option> </option>"),St=U('<div class="fixed inset-0 bg-black/50 flex items-center justify-center p-4"><div class="bg-neutral-900 rounded-lg shadow-lg max-w-lg w-full p-6"><h2 class="text-xl font-semibold mb-4">Deploy New Sidecar</h2> <form class="space-y-4"><div><label class="block text-sm font-medium mb-1">Sidecar Type</label> <select class="w-full px-3 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:border-blue-500"></select> <p class="mt-1 text-sm text-gray-400"> </p></div> <div><label class="block text-sm font-medium mb-1">Name</label> <input type="text" placeholder="Enter sidecar name" class="w-full px-3 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:border-blue-500" required></div> <div><label class="block text-sm font-medium mb-1">Command</label> <input type="text" placeholder="Enter command to run" class="w-full px-3 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:border-blue-500" required></div> <div><label class="block text-sm font-medium mb-1">Memory Limit (MB)</label> <input type="number" min="64" max="2048" step="64" class="w-full px-3 py-2 bg-neutral-800 border border-neutral-700 rounded-lg focus:outline-none focus:border-blue-500" required></div> <div class="flex justify-end space-x-3 mt-6"><button type="button" class="px-4 py-2 bg-neutral-800 hover:bg-neutral-700 rounded-lg transition-colors">Cancel</button> <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50"> </button></div></form></div></div>'),$t=U('<div class="flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0"><div class="relative w-full sm:w-96"><!> <input type="text" placeholder="Search sidecars..." class="w-full pl-10 pr-4 py-2 bg-neutral-900 border border-neutral-800 rounded-lg focus:outline-none focus:border-blue-500"></div> <div class="flex space-x-3 w-full sm:w-auto"><button class="flex-1 sm:flex-none flex items-center justify-center space-x-2 px-4 py-2 bg-neutral-800 hover:bg-neutral-700 rounded-lg transition-colors disabled:opacity-50"><!> <span>Start</span></button> <button class="flex-1 sm:flex-none flex items-center justify-center space-x-2 px-4 py-2 bg-neutral-800 hover:bg-neutral-700 rounded-lg transition-colors disabled:opacity-50"><!> <span>Stop</span></button> <button class="flex-1 sm:flex-none flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors"><!> <span>New Sidecar</span></button></div></div> <div class="mt-6 overflow-x-auto"><table class="w-full"><thead><tr class="text-left border-b border-neutral-800"><th class="p-4"><input type="checkbox" class="rounded border-neutral-700 text-blue-500 focus:ring-blue-500"></th><th class="p-4 cursor-pointer"><div class="flex items-center space-x-2"><span>Name</span> <!></div></th><th class="p-4">Status</th><th class="p-4">Process ID</th><th class="p-4">Memory</th><th class="p-4">CPU</th><th class="p-4">Age</th><th class="p-4"></th></tr></thead><tbody></tbody></table></div> <!>',1);function kt(V,R){We(R,!1);const b=lt(),d=()=>it(Je,"$page",b),w=m(),D=m(),p=m(),B=(s=10)=>{const o=["consul","spring-cloud-config-sidecar","prometheus-node-exporter","statsd","prometheus-node-exporter","statsd","fluentd","logstash","vector","envoy","istio-proxy","redis","memcached"],v=["RUNNING","STOPPED","FAILED"],E=[.85,.1,.05],P=()=>{const g=Math.random();let $=0;for(let k=0;k<v.length;(k+=1)-1)if($+=E[k],g<$)return v[k];return v[0]};return Array.from({length:s},(g,$)=>{const k=o[Math.floor(Math.random()*o.length)],I=P(),H=`pid-${Math.random().toString(36).substr(2,9)}`;return{id:($+1).toString(),name:`${k}-0`,type:k,state:I,processId:H,memory_usage:I==="RUNNING"?Math.floor(Math.random()*512):0,cpu_usage:I==="RUNNING"?Math.floor(Math.random()*30):0,created_at:new Date(Date.now()-Math.floor(Math.random()*30*24*60*60*1e3)).toISOString()}})};let f=m(""),S=m("name"),M=m("asc"),u=m(new Set),L=m(!1),_=m(!1),n=m({name:"",type:"logger",memory_limit:256,command:""});const G={logger:{name:"Promethius",description:"Captures and forwards application logs",default_command:"/usr/local/bin/log-forwarder",memory_limit:256},metrics:{name:"Netdata Agent",description:"Collects application metrics",default_command:"/usr/local/bin/metrics-agent",memory_limit:384}},F=B(5);function ne(s){e(S)===s?l(M,e(M)==="asc"?"desc":"asc"):(l(S,s),l(M,"asc"))}function le(s){switch(s){case"RUNNING":return"text-green-400";case"STOPPED":return"text-gray-400";case"FAILED":return"text-red-400";default:return"text-yellow-400"}}function q(s){l(_,!0),console.log(`Bulk ${s}:`,Array.from(e(u))),setTimeout(()=>{l(_,!1)},1e3)}async function ie(){l(_,!0);try{await new Promise(s=>setTimeout(s,1500)),console.log("Deploying sidecar:",e(n)),l(n,{name:"",type:"logger",memory_limit:256,command:""}),l(L,!1)}catch(s){console.error("Error deploying sidecar:",s)}finally{l(_,!1)}}function ce(s){const o=G[s];l(n,{...e(n),type:s,command:o.default_command,memory_limit:o.memory_limit})}Ee(()=>(e(f),e(M),e(S)),()=>{l(w,F.filter(s=>s.name.toLowerCase().includes(e(f).toLowerCase())||s.type.toLowerCase().includes(e(f).toLowerCase())).sort((s,o)=>{const v=e(M)==="asc"?1:-1;return s[e(S)]>o[e(S)]?v:-v}))}),Ee(()=>d(),()=>{l(D,d().params.orgId)}),Ee(()=>d(),()=>{l(p,d().params.spaceId)}),ot(),Fe();var de=$t(),i=He(de),c=a(i),W=a(c);vt(W,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"});var N=r(W,2);z(N),t(c);var Y=r(c,2),A=a(Y),he=a(A);Be(he,{class:"w-4 h-4"}),be(2),t(A);var K=r(A,2),pe=a(K);ze(pe,{class:"w-4 h-4"}),be(2),t(K);var ye=r(K,2),Ye=a(ye);bt(Ye,{class:"w-4 h-4"}),be(2),t(ye),t(Y),t(i);var we=r(i,2),Pe=a(we),Se=a(Pe),Te=a(Se),$e=a(Te),ke=a($e);z(ke),t($e);var Ne=r($e),je=a(Ne),Ze=r(a(je),2);mt(Ze,{class:"w-4 h-4"}),t(je),t(Ne),be(6),t(Te),t(Se);var Le=r(Se);ge(Le,5,()=>e(w),xe,(s,o)=>{var v=yt(),E=a(v),P=a(E);z(P),C(()=>Oe(P,e(u).has(e(o).id))),t(E);var g=r(E),$=a(g),k=a($,!0);t($);var I=r($,2),H=a(I,!0);t(I),t(g);var O=r(g),Z=a(O),Q=a(Z),ue=Ke(()=>`w-4 h-4 ${le(e(o).state)??""}`);ft(Q,{get class(){return e(ue)}});var X=r(Q,2);const ve=Ke(()=>le(e(o).state));var ee=a(X,!0);t(X),t(Z),t(O);var te=r(O),x=a(te),ae=a(x);Ve(ae,{class:"w-4 h-4 text-blue-400"});var J=r(ae,2),Ie=a(J,!0);t(J),t(x),t(te);var T=r(te),re=a(T),Ce=a(re);t(re),t(T);var De=r(T),Ue=a(De),tt=a(Ue);t(Ue),t(De);var Me=r(De),Re=a(Me),at=a(Re,!0);C(()=>h(at,new Date(e(o).created_at).toLocaleDateString())),t(Re),t(Me);var Ge=r(Me),qe=a(Ge),Ae=a(qe),rt=a(Ae);_e(rt,()=>e(o).state==="RUNNING",se=>{ze(se,{class:"w-4 h-4"})},se=>{Be(se,{class:"w-4 h-4"})}),t(Ae),t(qe),t(Ge),t(v),C(()=>{h(k,e(o).name),h(H,e(o).type),Xe(X,e(ve)),h(ee,e(o).state),h(Ie,e(o).processId),h(Ce,`${e(o).memory_usage??""}MB`),h(tt,`${e(o).cpu_usage??""}%`)}),y("change",P,se=>{se.target.checked?e(u).add(e(o).id):e(u).delete(e(o).id),l(u,e(u))}),y("click",Ae,()=>q(e(o).state==="RUNNING"?"stop":"start")),j(s,v)}),t(Le),t(Pe),t(we);var et=r(we,2);_e(et,()=>e(L),s=>{var o=St(),v=a(o),E=r(a(v),2),P=a(E),g=r(a(P),2);C(()=>{e(n).type,nt(()=>{})}),ge(g,5,()=>Object.entries(G),xe,(x,ae)=>{let J=()=>e(ae)[0],Ie=()=>e(ae)[1];var T=wt(),re={},Ce=a(T,!0);t(T),C(()=>{re!==(re=J())&&(T.value=(T.__value=J())==null?"":J()),h(Ce,Ie().name)}),j(x,T)}),t(g);var $=r(g,2),k=a($,!0);t($),t(P);var I=r(P,2),H=r(a(I),2);z(H),t(I);var O=r(I,2),Z=r(a(O),2);z(Z),t(O);var Q=r(O,2),ue=r(a(Q),2);z(ue),t(Q);var X=r(Q,2),ve=a(X),ee=r(ve,2),te=a(ee,!0);t(ee),t(X),t(E),t(v),t(o),C(()=>{h(k,G[e(n).type].description),ee.disabled=e(_),h(te,e(_)?"Deploying...":"Deploy")}),pt(g,()=>e(n).type,x=>me(n,e(n).type=x)),y("change",g,()=>ce(e(n).type)),oe(H,()=>e(n).name,x=>me(n,e(n).name=x)),oe(Z,()=>e(n).command,x=>me(n,e(n).command=x)),oe(ue,()=>e(n).memory_limit,x=>me(n,e(n).memory_limit=x)),y("click",ve,()=>l(L,!1)),y("submit",E,ut(ie)),j(s,o)}),C(()=>{A.disabled=e(u).size===0||e(_),K.disabled=e(u).size===0||e(_),Oe(ke,e(u).size===F.length)}),oe(N,()=>e(f),s=>l(f,s)),y("click",A,()=>q("start")),y("click",K,()=>q("stop")),y("click",ye,()=>l(L,!0)),y("change",ke,s=>{l(u,s.target.checked?new Set(F.map(o=>o.id)):new Set)}),y("click",Ne,()=>ne("name")),j(V,de),Qe()}var Nt=U('<button><div class="flex items-center gap-2"><span> </span> <span class="inline-block px-1.5 py-0.5 text-xs font-medium bg-neutral-800 text-gray-400 rounded border border-neutral-700 shadow-sm"></span></div></button>'),It=U('<div class="space-y-6 min-h-screen bg-neutral-950 text-gray-300 p-6"><div class="flex justify-between items-center mb-6"><div class="text-sm text-gray-400"><a href="/app/orgs" class="hover:text-white transition-colors">Organizations /</a> <a class="hover:text-white transition-colors"></a> <span class="mx-0">/ space /</span> <a class="hover:text-white transition-colors"></a> <span class="mx-0">/ app /</span> <a class="hover:text-white transition-colors"></a> <span class="mx-0">/instance/</span> <a class="hover:text-white transition-colors"></a> <div class="flex items-center space-x-3 pt-5"><!> <h1 class="text-2xl font-semibold text-white"></h1></div></div></div> <div class="border-b border-gray-700"><nav class="-mb-px flex space-x-8"></nav></div> <div class="py-4"><!></div></div>');function Wt(V,R){We(R,!1);const{orgId:b,spaceId:d,appId:w,instanceId:D}=_t(Je).params;let p=m("Sidecars");const B=["Sidecars","console"];function f(i){const c=parseInt(i.key);c>=1&&c<=6&&!i.ctrlKey&&!i.altKey&&!i.metaKey&&!i.shiftKey&&(["INPUT","TEXTAREA"].includes(i.target.tagName)||(i.preventDefault(),l(p,B[c-1])))}ct(()=>{window.addEventListener("keydown",f)}),dt(()=>{window.removeEventListener("keydown",f)}),Fe();var S=It(),M=a(S),u=a(M),L=r(a(u),2);fe(L,"href",`/app/org/${b??""}`),L.textContent=b;var _=r(L,4);fe(_,"href",`/app/org/${b??""}/space/${d??""}`),_.textContent=d;var n=r(_,4);fe(n,"href",`/app/org/${b??""}/space/${d??""}/app/${w??""}`),n.textContent=w;var G=r(n,4);fe(G,"href",`/app/org/${b??""}/space/${d??""}/app/${w??""}/instance/${D??""}`),G.textContent=D;var F=r(G,2),ne=a(F);Ve(ne,{class:"w-6 h-6 text-blue-400"});var le=r(ne,2);le.textContent=`Instance ${D??""} of app ${w??""}`,t(F),t(u),t(M);var q=r(M,2),ie=a(q);ge(ie,5,()=>B,xe,(i,c,W)=>{var N=Nt(),Y=a(N),A=a(Y),he=a(A,!0);C(()=>h(he,e(c).split("-").map(pe=>pe.charAt(0).toUpperCase()+pe.slice(1)).join(" "))),t(A);var K=r(A,2);K.textContent=W+1,t(Y),t(N),C(()=>Xe(N,`py-2 px-1 border-b-2 ${(e(p)===e(c)?"border-blue-500 text-blue-500":"border-transparent hover:border-gray-700 hover:text-gray-200")??""}`)),y("click",N,()=>l(p,e(c))),j(i,N)}),t(ie),t(q);var ce=r(q,2),de=a(ce);_e(de,()=>e(p)==="Sidecars",i=>{kt(i,{})},i=>{var c=st(),W=He(c);_e(W,()=>e(p)==="console",N=>{ht(N)},null,!0),j(i,c)}),t(ce),t(S),j(V,S),Qe()}export{Wt as component};
